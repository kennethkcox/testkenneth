window.OnewebContactForm=function($){var ContactFormValidation;function htmlEncode(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function runPipe(fnPipe,data){return fnPipe.reduce((function(newData,fn){return fn(newData)}),data)}return(ContactFormValidation=function(cfg){try{this.init(cfg)}catch(e){throw new Error("ContactForm Validation initialization failed")}}).prototype={constructor:window.OnewebContactForm,init:function(cfg){this.formDOMId=cfg.formDOMId,this.postURL=cfg.postURL,this.recipientEmail=decodeURIComponent(cfg.recipientEmail),this.successMessage=decodeURIComponent(cfg.successMessage),this.errorMessage=decodeURIComponent(cfg.errorMessage),this.formElementsErrorMessages=JSON.parse(cfg.formElementsErrorMessages),this.allFieldErrorMessage=JSON.parse(cfg.allFieldErrorMessage),this.emailRegex=new RegExp(cfg.emailRegex,"i"),this.urlRegex=new RegExp(cfg.urlRegex),this.numberRegex=/^[0-9+\(\)#\.\s]+$/,this.numberQuery='input[ctype="number"],input[type="number"]',this.previewMode=cfg.previewMode,this.usePHPSubmitHandler=cfg.usePHPSubmitHandler,this.attachSubmitEvent(),this.attachNumberInputValidation(),this.formFieldErrors=[],this.contactFormDOM={},this.formData={recipient:this.recipientEmail,email:this.recipientEmail,subject:decodeURIComponent(cfg.subject)},this.defaultFormData=$.extend({},this.formData),this.originalCharset=this.getDocumentCharset(),this.attachSubmitEvent()},attachSubmitEvent:function(){$('.oneWebCntForm input[type="submit"]').click($.proxy(this.validateForm,this))},attachNumberInputValidation:function(){var regex=this.numberRegex;$(".contact-form-field-container > "+this.numberQuery).on("input",(function(){var $this=$(this),value=$this.val();if(!regex.test(value)){var pattern="[^"+regex.source.replace(/^\^\[(.*?)\]\+\$$/,"$1")+"]",newValue=value.replace(new RegExp(pattern,"g"),"");$this.val(newValue)}}))},validateForm:function(event){if(event.preventDefault(),event.stopImmediatePropagation(),this.removeSuccessMessageOnFormFields($("#contactFormResponseContainer")),this.contactFormDOM=$(".oneWebCntForm"),this.removeErrorMessageWarningOnFormFields(this.contactFormDOM),this.setDocumentCharset("ISO-8859-1"),0!==this.getFormValidationErrors(this.contactFormDOM)){var errEl=$(".contact-form-field-container .error-message")[0];return errEl&&errEl.scrollIntoView(),this.setDocumentCharset(this.originalCharset),!1}this.updateFormData(this.contactFormDOM),this.isHiddenFieldEmpty()&&!this.previewMode&&(this.postContactForm(),this.formData=$.extend(!0,{},this.defaultFormData))},removeErrorMessageWarningOnFormFields:function(formDOM){$(formDOM).find(".error-message").remove()},removeSuccessMessageOnFormFields:function(successMsgDOM){$(successMsgDOM).html("").removeClass("formSuccess")},getFormValidationErrors:function(formDOM){var formFields=formDOM.find(".contact-form-field-container"),emailRegex=this.emailRegex,urlRegex=this.urlRegex,messageRegex=/^\S*/g,numberRegex=this.numberRegex,errors=0;return $.each(formFields,$.proxy((function(index,element){var inputFieldVal,text,errorMessage=this.formElementsErrorMessages[index],errorFound=!1,$numberField=$(element).find(this.numberQuery),isNumberField=1===$numberField.length;if(errorMessage=errorMessage&&decodeURIComponent(errorMessage),$(element).find('input[type="text"]')[0]&&!isNumberField&&errorMessage)!(text=$.trim($(element).find('input[type="text"]').val())).length&&text.match(messageRegex)&&(errorFound=!0);else if($(element).find('input[type="email"]')[0])inputFieldVal=$(element).find('input[type="email"]').val(),(errorMessage||inputFieldVal)&&(errorMessage=errorMessage||decodeURIComponent(this.allFieldErrorMessage[index]),emailRegex.test(inputFieldVal)||(errorFound=!0));else if($(element).find('input[type="url"]')[0])inputFieldVal=$(element).find('input[type="url"]').val(),(errorMessage||inputFieldVal)&&(errorMessage=errorMessage||decodeURIComponent(this.allFieldErrorMessage[index]),urlRegex.test(inputFieldVal)||urlRegex.test("http://"+inputFieldVal)||(errorFound=!0));else if(isNumberField)inputFieldVal=$numberField.val(),(errorMessage||inputFieldVal)&&(errorMessage=errorMessage||decodeURIComponent(this.allFieldErrorMessage[index]),inputFieldVal.match(numberRegex)||(errorFound=!0));else if($(element).find('input[type="tel"]')[0])inputFieldVal=$(element).find('input[type="tel"]').val(),(errorMessage||inputFieldVal)&&(errorMessage=errorMessage||decodeURIComponent(this.allFieldErrorMessage[index]),inputFieldVal.match(numberRegex)||(errorFound=!0));else if($(element).find('input[type="checkbox"]').length>0&&errorMessage)$(element).find('input[type="checkbox"]:checked')[0]||(errorFound=!0);else if($(element).find('input[type="radio"]').length>0&&errorMessage)$(element).find('input[type="radio"]:checked')[0]||(errorFound=!0);else if($(element).find("textarea")[0]&&errorMessage)!(text=$.trim($(element).find("textarea").val())).length&&text.match(messageRegex)&&(errorFound=!0);else if($(element).find("select")[0]&&errorMessage){var selectedValue=$(element).find("select").val();selectedValue||"--"===selectedValue||(errorFound=!0)}var errContainer=$(element).next();errorFound?(errContainer.html(htmlEncode(errorMessage)),errors+=1):errContainer.html("&nbsp;")}),this)),errors},updateFormData:function(formDOM){var formFields=$(formDOM).find(".contact-form-field-container"),existingNames=Object.keys(this.formData);$.each(formFields,$.proxy((function(index,element){var labelName=$(element).find("label").attr("data-label");labelName=function(fieldName,existingNames){for(var uniqueName=fieldName,count=1;-1!==existingNames.indexOf(uniqueName);)uniqueName=fieldName+"_"+count,count++;return uniqueName}(labelName,existingNames),existingNames.push(labelName),$(element).find('input[type="text"]')[0]||$(element).find('input[type="url"]')[0]||$(element).find(this.numberQuery)[0]||$(element).find('input[type="tel"]')[0]?this.formData[labelName]=$(element).find("input").val():$(element).find('input[type="email"]')[0]?(labelName="email"===labelName?"Email":labelName,this.formData.replyto?this.formData[labelName]=$(element).find("input").val():this.formData.replyto=this.formData[labelName]=$(element).find("input").val()):$(element).find('input[type="checkbox"]:checked')[0]?this.formData[labelName]=$(element).find('input[type="checkbox"]:checked').map((function(index,ele){return $(ele).val()})).get():$(element).find('input[type="radio"]:checked')[0]?this.formData[labelName]=$(element).find('input[type="radio"]:checked').val():$(element).find("select")[0]?this.formData[labelName]=$(element).find("select").val():$(element).find("textarea")[0]&&(this.formData[labelName]=$(element).find("textarea").val())}),this))},getEncodedFormData:function(){var encodedFormData="",replacePlus=function(data){return data.replace(/\+/g,"%2B")},fnPipe=this.usePHPSubmitHandler?[encodeURIComponent,replacePlus]:[escape,encodeURIComponent,unescape,replacePlus];for(var key in this.formData){encodedFormData+=runPipe(fnPipe,key.replace(/[\[\]]+/g,"_"))+"="+runPipe(fnPipe,this.formData[key])+"&"}return encodedFormData=encodedFormData.substring(0,encodedFormData.length-1)},isHiddenFieldEmpty:function(){var element=$(this.contactFormDOM).find('.contact-form-field-container>input[name="some-randome-random"]');return""===element.text()&&""===element.val()},postContactForm:function(){$.ajax({type:"POST",url:this.postURL,beforeSend:function(xhr){xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")},data:this.getEncodedFormData(),success:$.proxy(this.ajaxSuccess,this),error:$.proxy(this.ajaxError,this)})},ajaxSuccess:function(responseText){var responseStatus=$("#contactFormResponseContainer");/<title>\s*Error/i.test(responseText)?$(responseStatus).html(htmlEncode(this.errorMessage)).addClass("formError").removeClass("formSuccess"):($(responseStatus).html(htmlEncode(this.successMessage)).addClass("formSuccess").removeClass("formError"),this.trackFormSubmit()),this.resetDocument()},ajaxError:function(){var responseStatus=$("#contactFormResponseContainer");$(responseStatus).html(this.errorMessage).addClass("formError")},resetDocument:function(){$(this.contactFormDOM).trigger("reset"),this.setDocumentCharset(this.originalCharset)},getDocumentCharset:function(){return document.characterSet||document.charset},setDocumentCharset:function(charset){document.charset?document.charset=charset:document.characterSet=charset},trackFormSubmit:function(){const sw=window.sw;sw&&sw.register_contact_form&&sw.register_contact_form()}},ContactFormValidation}(oneJQuery);