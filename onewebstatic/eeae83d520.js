var MENU_DROPDOWN_FADEIN_TIME=350;!function($){function getFittingItemsCount(widthAvailableForItems,itemsWidths){return itemsWidths.reduce((function(acc,width){var widthAcc=acc[0],count=acc[1];return widthAcc+width>widthAvailableForItems?[widthAcc+width,count]:[widthAcc+width,count+1]}),[0,0])[1]}var isGoogle,userAgent,androidDesktopMode=!((isGoogle=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.appVersion)[1],10)&&0===navigator.vendor.indexOf("Google"))&&navigator.userAgent.indexOf("Android")>0)&&isGoogle&&0===navigator.platform.indexOf("Linux a")&&"ontouchstart"in document.documentElement,followTwoClicksEnabled=androidDesktopMode||(userAgent=navigator.userAgent.toLowerCase(),/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(userAgent));function liToWidth(index,li){return li.clientWidth}function isModernLayoutMenu($el){return $el.hasClass("modernLayoutMenu")}var isMoreButtonExists=[],moreButtons=[],deletedMoreBtns=[],isModernLayoutMenuExists=!!$(".menu.moreEnabled.modernLayoutMenu:not(.jsdropdown)").length;isModernLayoutMenuExists&&$(".menu.moreEnabled.modernLayoutMenu:not(.jsdropdown)").each((function(index,menu){var $menu=$(menu),$menuWrapper=$menu.parents('[data-kind="MENU"]'),$parentCol=$($menuWrapper.parents(".col")[0]);$menu.css("width","auto"),$menuWrapper.css("width","auto"),$parentCol.css("width","auto"),$parentCol.css("flex-grow","1")})),$(".moreEnabled:not(.jsdropdown)").each((function(index,menu){$(menu).css("display",""),isMoreButtonExists[index]=!0}));var originalMenuOffset,cleanLi,cleanLiTimer,cleanContainer,cleanContainerTimer,isInitialState=!0;function fixMoreButtons(fixSpecificIndex){$(".moreEnabled:not(.jsdropdown)").each((function(index,menu){if(null==fixSpecificIndex||index===fixSpecificIndex){var isHorizontalalignfit=$(menu).hasClass("horizontalalignfit");isHorizontalalignfit&&$(menu).children("ul").children("li").css({display:"inline-table"});var $moreBtnUl,menuHiddenClassName,$menu=$(menu),$ul=$menu.children("ul"),$lis=$ul.children("ul > li"),lisWidths=$lis.map(liToWidth).toArray(),totalItemsExcludingMore=lisWidths.length-1,$menuWrapper=$menu.parents('[data-kind="MENU"]'),$parentCol=$($menuWrapper.parents(".col")[0]),menuWidth=isModernLayoutMenu($menu)?Math.max($parentCol.width()-10,lisWidths[0]+lisWidths[lisWidths.length-1]):function(menu){var $tempMenu=menu.clone(),width=$tempMenu.width();return $tempMenu.hasClass("horizontalalignfit")&&($tempMenu.removeClass("horizontalalignfit"),width=$tempMenu.width()),$tempMenu.remove(),width}($menu),moreBtnIndex=lisWidths.length-1,moreBtnWidth=lisWidths[moreBtnIndex],$moreBtn=$($lis[moreBtnIndex]),fittingItemsExcludingMore=getFittingItemsCount(menuWidth,lisWidths.slice(0,-1));if(isHorizontalalignfit&&$(menu).children("ul").children("li").css({display:""}),isInitialState&&(moreButtons[index]=$moreBtn),isMoreButtonExists[index]){if(fittingItemsExcludingMore<totalItemsExcludingMore+(isInitialState?0:1)){var fittingItemsWithMore=getFittingItemsCount(menuWidth-moreBtnWidth,lisWidths.slice(0,-1));$moreBtnUl=$moreBtn.children("ul");var $itemsToMoveIntoMoreBtn=$lis.slice(fittingItemsWithMore,moreBtnIndex);if(menuHiddenClassName=$moreBtnUl.children().first().attr("class"),!$itemsToMoveIntoMoreBtn.length){var $lisFromMoreButton=$moreBtnUl.children("li"),$menuClone=$menu.clone();$("body").append($menuClone),$menuClone.css({position:"fixed",left:"-1000",top:"-1000"});var $ulClone=$menuClone.children("ul"),$lisClone=$ulClone.children("ul > li"),$moreBtnClone=$($lisClone[$lisClone.length-1]),$lisFromMoreButtonClone=$moreBtnClone.children("ul").children("li"),ulCloneHeight=$ulClone.height();$lisFromMoreButtonClone.children(".level-1").removeClass("level-1").addClass("level-0"),$moreBtnClone.remove(),$ulClone.append($lisFromMoreButtonClone);var ulCloneHeightAfterChange=$ulClone.height(),newLisWidths=$ulClone.children("li").map(liToWidth).toArray(),newFittingItemsExcludingMore=getFittingItemsCount(menuWidth,newLisWidths);if((isModernLayoutMenu($menu)||ulCloneHeight===ulCloneHeightAfterChange)&&newFittingItemsExcludingMore>fittingItemsExcludingMore){var $itemsToMove,numberOfItemsToMove=newFittingItemsExcludingMore-fittingItemsExcludingMore;if(numberOfItemsToMove===$lisFromMoreButton.length)deleteMoreButton(),$itemsToMove=$lisFromMoreButton.slice(0,numberOfItemsToMove);else{var newFittingItemsWithMore=getFittingItemsCount(menuWidth-moreBtnWidth,newLisWidths);newFittingItemsWithMore>fittingItemsWithMore&&(numberOfItemsToMove=newFittingItemsWithMore-fittingItemsWithMore,$itemsToMove=$lisFromMoreButton.slice(0,numberOfItemsToMove))}$itemsToMove&&$itemsToMove.length&&($itemsToMoveIntoMoreBtn.attr("class",menuHiddenClassName),$itemsToMove.children(".level-1").removeClass("level-1").addClass("level-0"),$itemsToMove.detach(),$moreBtn.detach(),$ul.append($itemsToMove),numberOfItemsToMove!==$lisFromMoreButton.length&&$ul.append($moreBtn),fixDropdownMenus())}return void $menuClone.remove()}$itemsToMoveIntoMoreBtn.last().find("div").remove(),$itemsToMoveIntoMoreBtn.attr("class",menuHiddenClassName),$itemsToMoveIntoMoreBtn.children(".level-0").removeClass("level-0").addClass("level-1"),isInitialState&&$moreBtnUl.children().remove(),$itemsToMoveIntoMoreBtn.detach(),$moreBtnUl.prepend($itemsToMoveIntoMoreBtn)}else isInitialState&&(deleteMoreButton(),$($lis[moreBtnIndex-1]).children(".divider").remove())}else{var firstLiTop,lastLiTop,spanHeight;try{firstLiTop=$($lis[0]).find("span").offset().top,lastLiTop=$($lis[$lis.length-1]).find("span").offset().top,spanHeight=$($lis[0]).find("span").clientHeight}catch(err){firstLiTop=0,lastLiTop=0,spanHeight=5}if(Math.abs(firstLiTop-lastLiTop)>spanHeight&&lastLiTop>firstLiTop){menuHiddenClassName=($moreBtnUl=($moreBtn=moreButtons[index]).children("ul")).children().first().attr("class"),$moreBtnUl.children().remove();var $lastMenuItem=$($lis[$lis.length-1]);$lastMenuItem.children(".level-0").removeClass("level-0").addClass("level-1"),$lastMenuItem.attr("class",menuHiddenClassName),$lastMenuItem.detach(),$moreBtnUl.append($lastMenuItem),$ul.append($moreBtn),isMoreButtonExists[index]=!0,fixDropdownMenus()}}}function deleteMoreButton(){isMoreButtonExists[index]=!1,deletedMoreBtns[index]=$moreBtn,$moreBtn.remove()}})),isInitialState=!1}function getParentLi($el){return $el.parents("li")[0]}function addExpandedClass($el){$el.addClass("expanded")}function removeExpandedClass($el){$el.removeClass("expanded")}function addHoverClass($el){$el.addClass("hover")}function removeHoverClass($el){$el.removeClass("hover")}function hasChildren($a){return 0!==$a.parent().find("ul").length}function makeAttachExpandedClassesOnHoverForSelfAndParentA(subMenuLiClone){return function(a){for(var $a=$(a),aHasChildren=hasChildren($a),currentParent=getParentLi($(getParentLi($a))),$parentAnchors=[],counter=0;currentParent!==subMenuLiClone;){if(counter>100)throw new Error("Can't find subMenuLiClone as parent");var $currentParent=$(currentParent),$parentAnchor=$($currentParent.find("> a"));$parentAnchors.push($parentAnchor),currentParent=getParentLi($currentParent),counter++}function applyDirection(direction){$a.parent("li").children("ul").css({left:"right"==direction?"100%":"none",right:"left"==direction?"100%":"none"})}aHasChildren&&androidDesktopMode&&$a.on("click",(function(event){if(!$a.data("isSecondTimeClicked"))return $a.data("isSecondTimeClicked",!0),event.stopPropagation(),!1})),$a.mouseenter((function(){aHasChildren&&(addExpandedClass($a),function(){var currentDropdownOffset=$a.parent("li").offset(),parentDropdownOffset=$a.parent("li").parent("ul").parent("li").offset(),expandableUlWidth=$a.parent("li").width(),ulClasses=$a.parents("div.menu.dropdown").attr("class").split(" ");function leftDirection(){applyDirection(currentDropdownOffset.left-expandableUlWidth<0?"right":"left")}function rightDirection(){currentDropdownOffset.left+2*expandableUlWidth>$(window).width()?applyDirection("left"):applyDirection("right")}isVerticalDropdown(ulClasses)&&currentDropdownOffset.left===parentDropdownOffset.left&&(parentDropdownOffset=originalMenuOffset),ulClasses.some((function(element){return"menuhorizontalright"===element}))?currentDropdownOffset.left<=parentDropdownOffset.left?leftDirection():rightDirection():currentDropdownOffset.left>=parentDropdownOffset.left?rightDirection():leftDirection()}()),addHoverClass($a),$parentAnchors.forEach((function($el){$el.parent("li").css({"z-index":2}),addExpandedClass($el),addHoverClass($el)}))})),$a.mouseleave((function(){aHasChildren&&(removeExpandedClass($a),androidDesktopMode&&$a.data("isSecondTimeClicked",!1)),removeHoverClass($a),$parentAnchors.forEach((function($el){$el.parent("li").css({"z-index":1}),removeExpandedClass($el),removeHoverClass($el)}))}))}}function isVerticalDropdown(classes){return classes.some((function(element){return"menuvertical"===element}))&&classes.some((function(element){return"dropdown"===element}))}function getMenuId($li){return $li.parents('[data-specific-kind="MENU"]').attr("data-id")}var menuReferences=[];function fixDropdownMenus(_isModernLayoutMenu){var menuDropdownSelector=_isModernLayoutMenu?"div.menu.dropdown.modernLayoutMenu":"div.menu.dropdown";$(menuDropdownSelector+" > ul > li").each((function(_,li){var $li=$(li),expandableUl=$li.find("ul")[0];if(expandableUl){if(-1!=menuReferences.indexOf(li))return;menuReferences.push(li),followTwoClicksEnabled&&$li.on("click",(function(event){if(!$li.data("isSecondTimeClicked"))return $li.data("isSecondTimeClicked",!0),event.stopPropagation(),!1}));var $a=$li.find("> a"),aHasChildren=hasChildren($a),contaierClassName=$li.parents(menuDropdownSelector).attr("class"),UlClassName=$li.parent("ul").attr("class"),$expandableUl=$(expandableUl),$parentUl=$($li.parent("ul")[0]),$containerClone=$(document.createElement("div"));$containerClone.css({position:"absolute",zIndex:1e4,left:0,top:0,height:"0px",display:"block"}),$containerClone.addClass(contaierClassName),$containerClone.attr("data-id",getMenuId($li)),$containerClone.addClass("jsdropdown");var $expandableUlClone,$subMenuUlClone=$(document.createElement("ul")),$subMenuLiClone=$(document.createElement("li")),attachExpandedClassesOnHoverForSelfAndParentA=makeAttachExpandedClassesOnHoverForSelfAndParentA($subMenuLiClone[0]);$subMenuUlClone.addClass(UlClassName),$subMenuUlClone.css({border:0,"padding-left":0,"padding-right":0}),$subMenuLiClone.css("position","absolute"),$containerClone.append($subMenuUlClone),$subMenuUlClone.append($subMenuLiClone),$(document.body).append($containerClone),$li.mouseenter((function(event){followTwoClicksEnabled&&$li.data("isSecondTimeClicked",!1),cleanContainerTimer&&(clearTimeout(cleanContainerTimer),cleanContainer()),cleanLiTimer&&(clearTimeout(cleanLiTimer),cleanLi()),aHasChildren&&addExpandedClass($a),originalMenuOffset=$li.offset(),addHoverClass($li);var expandableUlOffset=$expandableUl.offset(),expandableUlWidth=$expandableUl.width(),ulClasses=$containerClone.attr("class").split(" ");removeHoverClass($li),ulClasses.some((function(element){return"menuvertical"===element}))&&ulClasses.some((function(element){return"menuhorizontalright"===element}))||(expandableUlWidth=0);$(".template").offset();$expandableUlClone=$expandableUl.clone().hide(),ulClasses.some((function(element){return"modernLayoutMenu"===element}))?$expandableUlClone.appendTo($subMenuLiClone).fadeIn(MENU_DROPDOWN_FADEIN_TIME):$expandableUlClone.appendTo($subMenuLiClone).show(),$subMenuLiClone.find("a").toArray().forEach(attachExpandedClassesOnHoverForSelfAndParentA),addHoverClass($subMenuLiClone),addHoverClass($a),$expandableUl.addClass("wsbmenuhide");var isVerticalDropdownMenu=isVerticalDropdown(ulClasses),left=expandableUlOffset.left-parseInt($parentUl.css("padding-left"),10)+expandableUlWidth;!isVerticalDropdownMenu&&left+$expandableUlClone.width()>$(window).width()&&(left=$(window).width()-$expandableUlClone.width()),isVerticalDropdown(ulClasses)&&(left+$parentUl.width()+$expandableUlClone.width()>$(window).width()?left-=$parentUl.width():left+=$parentUl.width());var top=expandableUlOffset.top;$li.closest("[data-pin='1']").length&&(top-=$(window).scrollTop(),$containerClone.css("position","fixed")),top=top-parseInt($parentUl.css("padding-top"),10)-parseInt($("body")[0].style.top||0,10),$containerClone.css({left:left,top:top});var allFirstLevelLis=$subMenuLiClone.find("> ul > li"),allFirstLevelAncors=$subMenuLiClone.find("> ul > li > a"),allLevel1Width=allFirstLevelLis.map((function(index,li){return oneJQuery(li).width()})),maxWidth=Math.max.apply(null,allLevel1Width);allFirstLevelAncors.css("width",maxWidth),$subMenuLiClone.find("> ul li").mouseenter((function(e){var $li=$(e.target).parent("li"),allFirstLevelLis=$li.find("> ul > li"),allFirstLevelAncors=$li.find("> ul > li > a"),allLevel1Width=allFirstLevelLis.map((function(index,li){return oneJQuery(li).width()})),maxWidth=Math.max.apply(null,allLevel1Width);allFirstLevelAncors.css("width",maxWidth)}))})),$li.mouseleave((function(e){cleanLi=function(){removeExpandedClass($a),removeHoverClass($a),$expandableUl.removeClass("wsbmenuhide"),$.contains($containerClone[0],e.relatedTarget)||(removeHoverClass($subMenuLiClone),$expandableUlClone.remove()),cleanLiTimer=null},cleanLiTimer=setTimeout((function(){cleanLi()}),250)})),$containerClone.mouseenter((function(){if(cleanLiTimer&&clearTimeout(cleanLiTimer),cleanContainerTimer)return clearTimeout(cleanContainerTimer);addExpandedClass($a),addHoverClass($a)})),$containerClone.mouseleave((function(){cleanContainer=function(){removeExpandedClass($a),removeHoverClass($subMenuLiClone),removeHoverClass($a),$expandableUlClone.remove(),cleanContainerTimer=null},cleanContainerTimer=setTimeout((function(){cleanContainer()}),250)}))}}))}if(isMoreButtonExists.length){fixMoreButtons();var counter=200,interval=setInterval((function(){fixMoreButtons(),--counter||clearInterval(interval)}),100);isModernLayoutMenuExists&&$(window).resize((function(){var isFixDropDown=!1;$(".moreEnabled:not(.jsdropdown)").each((function(index,menu){var $menu=$(menu);if(isModernLayoutMenu($menu)){if(!isMoreButtonExists[index]&&(isMoreButtonExists[index]=!0,deletedMoreBtns[index])){$menu.children("ul").append(deletedMoreBtns[index]),isInitialState=!0;var $lis=$menu.children("ul").children("li"),lisArr=Array.from($lis);$lis.each((function(index,li){$(li).off("mouseenter"),$(li).off("mouseleave")}));var newMenuReferences=menuReferences.filter((function(ref){return!lisArr.includes(ref)}));newMenuReferences.length!==menuReferences.length&&(menuReferences=newMenuReferences,$('.jsdropdown.modernLayoutMenu[data-id="'+getMenuId($($lis[0]))+'"]').remove(),isFixDropDown=!0)}clearInterval(interval),fixMoreButtons(index)}})),isFixDropDown&&fixDropdownMenus(!0)}))}fixDropdownMenus()}(oneJQuery);