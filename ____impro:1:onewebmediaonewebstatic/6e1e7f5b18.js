"use strict";function HeightObserver(cb){var inbuilt="ResizeObserver"in window,that=this;return this.callback=inbuilt?function(entry){var newHeight=entry[0].target.clientHeight;newHeight!==that.currentHeight&&(cb(newHeight,that.currentHeight),that.currentHeight=newHeight)}:cb,this.observer=inbuilt?new ResizeObserver(this.callback):null,this}HeightObserver.prototype.observe=function(target){if(this.currentHeight=target.clientHeight,this.observer)this.observer.observe(target);else{var that=this;this.cancelIntervalId=setInterval((function(){var newHeight=target.clientHeight;newHeight!==that.currentHeight&&(that.callback(newHeight,that.currentHeight),that.currentHeight=newHeight)}),100)}},HeightObserver.prototype.disconnect=function(){this.observer?this.observer.disconnect():clearInterval(this.cancelIntervalId)};var containerKindsMap={STRIP:!0,SECTION:!0,BACKGROUND:!0,HOVERBOX:!0,IMAGE:!0};!function($){var attachments=JSON.parse(document.body.dataset.attachments),observerMap={},childToParentMap={},componentsMap={},getComponentNodeById=function(id){if(!componentsMap[id]){var node=document.querySelector('[data-id="'+id+'"][data-specific-kind]');componentsMap[id]=node}return componentsMap[id]},getComponentInfoFromNode=function(node){if(!node)return null;var id,top,height,rect=node.getBoundingClientRect();return id=node.dataset.id,height=node.clientHeight||$(node).height(),{id:id,top:top=Math.round(rect.top+window.scrollY),bottom:Math.round(top+height),height:height}},computeChildToParent=function computeChildToParent(acc,id){if(acc[id])return acc;acc[id]=!0;var node=getComponentNodeById(id);if(node){node.firstChild.style.minHeight=null;var children=attachments[id],cmpInfo=getComponentInfoFromNode(node),finalHeight=getComponentInfoFromNode(node).height;if(children&&children.length){children.forEach((function(childId){childToParentMap[id]=childId,computeChildToParent(acc,childId)}));var overlappingChildren=function(children){return children&&children.length?children.filter((function(id){var node=componentsMap[id];return node&&!!parseInt(node.dataset.bottomOverlap)})):[]}(children),currentBottom=cmpInfo.bottom,diff=function(children,overlappingChildren,currentBottom){return children.reduce((function(bottom,id){var node=getComponentNodeById(id),cmpInfo=getComponentInfoFromNode(node);if(!cmpInfo)return bottom;var childBottom=cmpInfo.bottom;if(-1!==overlappingChildren.indexOf(id)&&childBottom>bottom){var diff=childBottom-node.dataset.bottomOverlap-bottom;return diff>0?bottom+diff:bottom}return Math.max(bottom,childBottom)}),currentBottom)}(children,overlappingChildren,currentBottom)-currentBottom;diff>0&&(finalHeight+=diff),node.firstChild.style.minHeight=finalHeight+"px"}else if(!observerMap[id]){var heightObserver=new HeightObserver((function(newHeight,oldHeight){if(newHeight!==oldHeight){for(var childId=id,parentId=childToParentMap[childId];parentId;)parentId=childToParentMap[childId=parentId];updateHeights(attachments)}}));heightObserver.observe(node),observerMap[id]=heightObserver}return containerKindsMap[node.dataset.specificKind]&&(node.firstChild.style.minHeight=finalHeight+"px"),acc}};function updateHeights(attachments){Object.keys(attachments).reduce(computeChildToParent,{})}updateHeights(attachments),window.addEventListener("load",(function(){Object.values(observerMap).forEach((function(observer){observer.disconnect()}))}))}(oneJQuery);